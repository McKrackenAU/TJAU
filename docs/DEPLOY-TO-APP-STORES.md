# Deploying Tarot Journey to App Stores

This document provides step-by-step instructions for deploying the Tarot Journey app to both the Apple App Store and Google Play Store.

## Prerequisites

Before proceeding, ensure you have:

1. **Developer Accounts**:
   - Apple Developer Account ($99/year)
   - Google Play Developer Account ($25 one-time fee)

2. **Development Environment**:
   - Xcode (for iOS, macOS only)
   - Android Studio (for Android)
   - Node.js and npm

3. **App Assets**:
   - App icons (generated by our scripts)
   - Screenshots for all required device sizes
   - App description, keywords, and metadata

## Deployment Workflow

### Step 1: Build the Web Application

First, build the web application:

```bash
npm run build
```

### Step 2: Generate App Icons and Splash Screens

Generate all required icons and splash screens:

```bash
# Make the script executable
chmod +x scripts/generate-icons.sh

# Run the script
./scripts/generate-icons.sh
```

### Step 3: Add Native Platforms

Add both iOS and Android platforms to the project:

```bash
# Make the script executable
chmod +x scripts/cap-add-platforms.sh

# Run the script
./scripts/cap-add-platforms.sh
```

### Step 4: Sync Web Assets with Native Projects

Sync the web assets with the native platforms:

```bash
# Make the script executable
chmod +x scripts/cap-sync.sh

# Run the script
./scripts/cap-sync.sh
```

### Step 5: Configure Native Projects

#### iOS Configuration:

Open the iOS project in Xcode:

```bash
# Make the script executable
chmod +x scripts/open-ios.sh

# Run the script
./scripts/open-ios.sh
```

In Xcode:
1. Set up Signing & Capabilities:
   - Select your Apple Developer Team
   - Configure App ID and provisioning profiles

2. Configure App Store settings:
   - Set proper bundle identifier (io.tarotjourney.app)
   - Configure app version and build number
   - Enable necessary entitlements (Push Notifications, In-App Purchase, etc.)

#### Android Configuration:

Open the Android project in Android Studio:

```bash
# Make the script executable
chmod +x scripts/open-android.sh

# Run the script
./scripts/open-android.sh
```

In Android Studio:
1. Update `build.gradle` with:
   - Proper version code and name
   - Signing configuration for release builds

2. Create a signing key:
   ```bash
   keytool -genkey -v -keystore tarot-journey.keystore -alias tarotjourney -keyalg RSA -keysize 2048 -validity 10000
   ```

3. Configure `gradle.properties` with your signing information (keep this secure!)

### Step 6: Build Native App Packages

Build both iOS and Android packages:

```bash
# Make the script executable
chmod +x scripts/build-native-apps.sh

# Run the script
./scripts/build-native-apps.sh
```

This will generate:
- iOS: `.ipa` file (via Xcode Archive)
- Android: `.aab` and `.apk` files

### Step 7: Test on Physical Devices

Before submitting to app stores:
1. Install and test on real iOS and Android devices
2. Verify all features work correctly (login, subscriptions, etc.)
3. Check performance on various device sizes

### Step 8: Submit to App Stores

#### Apple App Store Submission:

1. Log into [App Store Connect](https://appstoreconnect.apple.com)
2. Create a new app entry
3. Fill in all required metadata
4. Upload screenshots and app preview videos
5. Upload your built .ipa file
6. Submit for review (typically takes 1-3 days)

#### Google Play Store Submission:

1. Log into [Google Play Console](https://play.google.com/console)
2. Create a new app
3. Fill in store listing information
4. Upload screenshots and graphics
5. Upload your signed .aab file
6. Set up in-app products
7. Submit for review (typically takes 1-3 days)

## Important Configuration Files

- `capacitor.config.ts`: Main Capacitor configuration
- `android/app/src/main/AndroidManifest.xml`: Android app manifest
- `ios/App/App/Info.plist`: iOS app information

## Troubleshooting

### Common iOS Issues:

1. **Code Signing Errors**:
   - Verify your provisioning profiles
   - Check that your certificates are valid and installed

2. **App Store Connect Warnings**:
   - Address any validation warnings before submission
   - Check for missing metadata or screenshots

### Common Android Issues:

1. **Signing Issues**:
   - Ensure keystore file is properly generated
   - Verify signing configuration in gradle files

2. **Play Store Listing Issues**:
   - Make sure all required fields are completed
   - Check that screenshot dimensions match requirements

## Additional Resources

- [App Store Review Guidelines](https://developer.apple.com/app-store/review/guidelines/)
- [Google Play Policy Center](https://play.google.com/about/developer-content-policy/)
- [Capacitor Documentation](https://capacitorjs.com/docs)

## Support

If you encounter any issues during the app store deployment process, please refer to:
- The full [App Store Submission Guide](./app-store-submission-guide.md)
- Contact your development team for assistance

---

Remember to keep all API keys, signing keys, and credentials secure!